{"title":"$:/plugins/wikilabs/keyvalues","description":"keyvalues - improve data-tiddler handling","author":"pmario","core-version":">=5.1.14","version":"0.1.1","list":"readme license history","plugin-type":"plugin","dependents":"","type":"application/json","text":"{\n    \"tiddlers\": {\n        \"$:/plugins/wikilabs/keyvalues/history\": {\n            \"title\": \"$:/plugins/wikilabs/keyvalues/history\",\n            \"text\": \"V 0.1.1 - 2020.01.19\\n\\n* Update license link/text\\n\\nV 0.1.0 - beta 2019.11.13\\n\\n* initial release\\n** name: keyvalues\\n\"\n        },\n        \"$:/core/modules/filters/keyvalues.js\": {\n            \"title\": \"$:/core/modules/filters/keyvalues.js\",\n            \"text\": \"/*\\\\\\ntitle: $:/core/modules/filters/keyvalues.js\\ntype: application/javascript\\nmodule-type: filteroperator\\n\\nFilter operator for returning the keys and values of a data tiddler\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\n/*\\nExport our filter function\\n*/\\nexports.keyvalues = function(source,operator,options) {\\n\\tvar results = [],\\n\\t\\tfieldList = [],\\n\\t\\tsep = \\\":\\\",\\n\\t\\tp1 = \\\"key\\\",\\n\\t\\tp2 = \\\"value\\\",\\n\\t\\tuseKey = true,\\n\\t\\tuseValue = false,\\n\\t\\tv1, v2, flags, pass, match, data,\\n\\t\\tregexp, regexpString;\\n\\n\\t// Process key, value parameters\\n\\tif(operator.suffixes && operator.suffixes[0].length > 0) {\\n\\t\\tfieldList = operator.suffixes[0];\\n\\t\\tp1 = fieldList[0] || \\\"\\\";\\n\\t\\tp2 = fieldList[1] || \\\"\\\";\\n\\t}\\n\\t// Process <separator>\\n\\tif(operator.suffixes && operator.suffixes[1]) {\\n\\t\\tsep = operator.suffixes[1][0] || \\\":\\\";\\n\\t}\\n\\t// Process usekey or usevalue flags\\n\\tif(operator.suffixes && operator.suffixes[2] && operator.suffixes[2][0]) {\\n\\t\\tuseKey = (operator.suffixes[2][0].toLowerCase() === \\\"usekey\\\");\\n\\t\\tuseValue = (operator.suffixes[2][0].toLowerCase() === \\\"usevalue\\\");\\n\\t}\\n\\t// Process regexp operand if available\\n\\tregexpString = operator.operand;\\n\\tif (regexpString) {\\n\\t\\tmatch = /^\\\\(\\\\?([gim]+)\\\\)/.exec(regexpString);\\n\\t\\tif(match) {\\n\\t\\t\\tflags = match[1];\\n\\t\\t\\tregexpString = regexpString.substr(match[0].length);\\n\\t\\t} else {\\n\\t\\t\\tmatch = /\\\\(\\\\?([gim]+)\\\\)$/.exec(regexpString);\\n\\t\\t\\tif(match) {\\n\\t\\t\\t\\tflags = match[1];\\n\\t\\t\\t\\tregexpString = regexpString.substr(0,regexpString.length - match[0].length);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\ttry {\\n\\t\\t\\tregexp = new RegExp(regexpString,flags);\\n\\t\\t} catch(e) {\\n\\t\\t\\treturn [\\\"\\\" + e];\\n\\t\\t}\\n\\t}\\n\\t// Process incoming values\\n\\tsource(function(tiddler,title) {\\n\\t\\tdata = options.wiki.getTiddlerDataCached(title);\\n\\t\\tif(data) {\\n\\t\\t\\t// remove separator if there is no v2 element\\n\\t\\t\\tsep = (p2) ? sep : \\\"\\\";\\n\\t\\t\\tfor (var [key, value] of Object.entries(data)) {\\n\\t\\t\\t\\tv1 = (p1 === \\\"key\\\") ? key : (p1 === \\\"value\\\") ? value : \\\"\\\";\\n\\t\\t\\t\\tv2 = (p2 === \\\"key\\\") ? key : (p2 === \\\"value\\\") ? value : \\\"\\\";\\n\\n\\t\\t\\t\\tif (regexpString) {\\n\\t\\t\\t\\t\\tpass = (useKey) ? regexp.exec(key) : (useValue) ? regexp.exec(value) : false;\\n\\t\\t\\t\\t\\tif (pass) {\\n\\t\\t\\t\\t\\t\\tresults.push(v1+sep+v2);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tresults.push(v1+sep+v2);\\n\\t\\t\\t\\t} // if regexpstring\\n\\t\\t\\t} // for\\n\\t\\t} // if data\\n\\t});\\n\\treturn results;\\n};\\n})();\\n\\n\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"filteroperator\"\n        },\n        \"$:/plugins/wikilabs/keyvalues/license\": {\n            \"title\": \"$:/plugins/wikilabs/keyvalues/license\",\n            \"text\": \"[[Key/Values-Plugin|https://wikilabs.github.io/#keyvalues]] (C) Mario Pietsch - 2019-2020\\n\\nhttps://opensource.org/licenses/BSD-3-Clause\\n\"\n        },\n        \"$:/plugins/wikilabs/keyvalues/readme\": {\n            \"title\": \"$:/plugins/wikilabs/keyvalues/readme\",\n            \"text\": \"\\nTODO\\n\"\n        }\n    }\n}"}